<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>TripSum Calculator</title>
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@700;800;900&family=Source+Sans+3:wght@400;500&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/tailwindcss-cdn@3.4.10/tailwindcss.js"></script>
  <link rel="stylesheet" href="styles/main.css">
  <style type="text/tailwindcss" data-teda="tailwind-apply">
    @layer components {
      .btn-primary { @apply inline-flex items-center justify-center whitespace-nowrap bg-[#0FA3B1] text-white font-medium px-4 md:px-5 py-2.5 md:py-3 rounded-full shadow-xl hover:bg-[#0b8691] active:bg-[#0a7680] focus:outline-none focus:ring-4 focus:ring-[#8EE1E7]/60 transition-all duration-300 z-20; }
      .btn-secondary { @apply inline-flex items-center justify-center whitespace-nowrap bg-white text-[#0FA3B1] font-medium px-4 md:px-5 py-2.5 md:py-3 rounded-full ring-1 ring-[#0FA3B1]/30 hover:bg-[#E8FBFD] focus:outline-none focus:ring-4 focus:ring-[#8EE1E7]/50 transition-all duration-300 z-20; }
      .btn-danger { @apply inline-flex items-center justify-center whitespace-nowrap bg-[#F25F5C] text-white font-medium px-3 py-2 rounded-full shadow-lg hover:bg-[#dc504d] focus:ring-4 focus:ring-[#F9A3A2]/60 transition-all duration-300; }
      .btn-ghost { @apply inline-flex items-center justify-center whitespace-nowrap px-3 py-2 rounded-full text-[#24324a]/80 hover:bg-black/5 focus:ring-2 focus:ring-black/10 transition-all duration-300; }
      .input { @apply w-full rounded-xl px-3.5 py-2.5 ring-1 ring-black/10 focus:ring-2 focus:ring-[#0FA3B1] outline-none bg-white transition-all duration-200; }
      .select { @apply w-full rounded-xl px-3.5 py-2.5 ring-1 ring-black/10 focus:ring-2 focus:ring-[#0FA3B1] outline-none bg-white transition-all duration-200; }
      .label { @apply text-sm font-medium text-[#24324a]/90; }
      .card { @apply bg-white rounded-2xl shadow-xl ring-1 ring-black/5; }
      .section-title { @apply text-2xl md:text-3xl font-black tracking-tight text-[#0B132B]; }
      .chip { @apply inline-flex items-center gap-2 text-xs font-medium px-2.5 py-1.5 rounded-full ring-1 ring-black/5 bg-white shadow-sm; }
    }
  </style>
</head>
<body class="min-h-screen bg-[#F8F7F3] text-[#24324a]" style="font-family: 'Source Sans 3', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;">
  <header class="w-full sticky top-0 z-30 bg-[#F8F7F3]/90 backdrop-blur border-b border-black/5">
    <div class="mx-auto max-w-7xl px-6 py-4 flex items-center justify-between">
      <a href="index.html" class="flex items-center gap-3" aria-label="Back to landing">
        <img src="assets/logo.svg" alt="TripSum logo" class="h-8 w-8"/>
        <span class="text-[#0B132B] font-black text-lg" style="font-family: 'Merriweather', Georgia, serif;">TripSum</span>
      </a>
      <div class="flex items-center gap-2 md:gap-3">
        <button id="exportBtn" class="btn-secondary">Export</button>
        <button id="importBtn" class="btn-secondary">Import</button>
        <button id="resetBtn" class="btn-danger">Reset</button>
      </div>
    </div>
  </header>

  <main class="mx-auto max-w-7xl px-6 py-6 md:py-10">
    <!-- Top controls -->
    <section class="mb-6 md:mb-8">
      <div class="card p-4 md:p-6">
        <div class="flex flex-col lg:flex-row items-start lg:items-center gap-4">
          <div class="flex-1">
            <h1 class="section-title" style="font-family: 'Merriweather', Georgia, serif;">Trip Budget Calculator</h1>
            <p class="text-sm text-[#24324a]/80 mt-1">Add expenses in any currency. We will convert to your base currency and keep totals by category.</p>
          </div>
          <div class="flex items-center gap-3 w-full sm:w-auto">
            <label for="baseCurrency" class="label whitespace-nowrap">Base currency</label>
            <select id="baseCurrency" class="select w-full sm:w-44"></select>
            <button id="fetchRatesBtn" class="btn-primary whitespace-nowrap">Update rates</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Main workspace -->
    <section class="flex flex-col lg:flex-row gap-6">
      <!-- Left: Forms and tables -->
      <div class="flex-1 space-y-6 min-w-0">
        <!-- Expense form -->
        <div class="card p-5 md:p-6">
          <h2 class="text-xl font-extrabold mb-4" style="font-family: 'Merriweather', Georgia, serif;">Add expense</h2>
          <form id="expenseForm" class="grid grid-cols-1 md:grid-cols-12 gap-3 md:gap-4" autocomplete="off">
            <div class="md:col-span-4">
              <label class="label" for="desc">Description</label>
              <input id="desc" type="text" class="input" placeholder="e.g., Museum tickets" required>
            </div>
            <div class="md:col-span-3">
              <label class="label" for="category">Category</label>
              <select id="category" class="select" required></select>
            </div>
            <div class="md:col-span-2">
              <label class="label" for="amount">Amount</label>
              <input id="amount" type="number" step="0.01" min="0" class="input" placeholder="0.00" required>
            </div>
            <div class="md:col-span-2">
              <label class="label" for="currency">Currency</label>
              <select id="currency" class="select" required></select>
            </div>
            <div class="md:col-span-1">
              <label class="label" for="date">Date</label>
              <input id="date" type="date" class="input">
            </div>
            <div class="md:col-span-9">
              <label class="label" for="note">Note</label>
              <input id="note" type="text" class="input" placeholder="Optional details...">
            </div>
            <div class="md:col-span-3 flex items-end">
              <button type="submit" class="btn-primary w-full">Add item</button>
            </div>
          </form>
        </div>

        <!-- Categories manager -->
        <div class="card p-5 md:p-6">
          <div class="flex items-center justify-between gap-3 flex-wrap">
            <h2 class="text-xl font-extrabold" style="font-family: 'Merriweather', Georgia, serif;">Categories</h2>
            <form id="categoryForm" class="flex items-center gap-2">
              <input id="newCategoryName" type="text" class="input w-44" placeholder="New category" required>
              <select id="newCategoryColor" class="select w-32">
                <option value="#0FA3B1">Teal</option>
                <option value="#F25F5C">Coral</option>
                <option value="#3D5A80">Slate</option>
                <option value="#9B5DE5">Violet</option>
                <option value="#00A676">Green</option>
                <option value="#FF7F50">Orange</option>
                <option value="#E63946">Red</option>
                <option value="#1D3557">Navy</option>
              </select>
              <button class="btn-secondary" type="submit">Add</button>
            </form>
          </div>
          <div id="categoriesList" class="mt-4 flex flex-wrap gap-3"></div>
        </div>

        <!-- Items table -->
        <div class="card p-4 md:p-5">
          <div class="flex items-center justify-between">
            <h2 class="text-xl font-extrabold" style="font-family: 'Merriweather', Georgia, serif;">Items</h2>
            <div class="text-sm text-[#24324a]/70"><span id="itemsCount">0</span> items</div>
          </div>
          <div class="mt-3 overflow-x-auto -mx-2 md:mx-0">
            <table class="min-w-[720px] w-full text-sm">
              <thead>
                <tr class="text-left text-[#24324a]/60">
                  <th class="py-2 px-2">Date</th>
                  <th class="py-2 px-2">Description</th>
                  <th class="py-2 px-2">Category</th>
                  <th class="py-2 px-2">Amount</th>
                  <th class="py-2 px-2">Converted</th>
                  <th class="py-2 px-2 text-right">Actions</th>
                </tr>
              </thead>
              <tbody id="itemsTableBody"></tbody>
            </table>
          </div>
        </div>

        <!-- Exchange Rates editor -->
        <div class="card p-5 md:p-6">
          <div class="flex items-center justify-between gap-3 flex-wrap">
            <h2 class="text-xl font-extrabold" style="font-family: 'Merriweather', Georgia, serif;">Exchange rates</h2>
            <p class="text-sm text-[#24324a]/70">Rates stored relative to USD. Conversion works between any two currencies.</p>
          </div>
          <div class="mt-4 overflow-x-auto -mx-2 md:mx-0">
            <table class="min-w-[600px] w-full text-sm">
              <thead>
                <tr class="text-left text-[#24324a]/60">
                  <th class="py-2 px-2">Currency</th>
                  <th class="py-2 px-2">1 Unit equals USD</th>
                  <th class="py-2 px-2">Edit</th>
                </tr>
              </thead>
              <tbody id="ratesTableBody"></tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Right: Summary -->
      <aside class="w-full lg:w-[30%] space-y-6">
        <div class="card p-5 md:p-6 sticky top-24">
          <h3 class="text-lg font-extrabold" style="font-family: 'Merriweather', Georgia, serif;">Summary</h3>
          <div id="summaryTotal" class="text-4xl font-black mt-2 text-[#0B132B]" style="font-family: 'Merriweather', Georgia, serif;">$0</div>
          <div id="summaryByCategory" class="mt-4 space-y-3"></div>
          <div class="mt-5 flex gap-2">
            <button id="addQuickMeal" class="btn-secondary w-full">+ Quick meal</button>
            <button id="addQuickTaxi" class="btn-secondary w-full">+ Quick taxi</button>
          </div>
        </div>
      </aside>
    </section>

    <!-- Hidden import input -->
    <input type="file" id="importFile" accept="application/json" class="hidden" />
  </main>

  <footer class="py-10">
    <div class="mx-auto max-w-7xl px-6 flex flex-col md:flex-row items-center justify-between gap-4">
      <p class="text-sm text-[#24324a]/70">Need the marketing page? <a class="link" href="index.html">Go back</a></p>
      <a href="#top" class="btn-ghost">Back to top</a>
    </div>
  </footer>

  <!-- Scripts: required order -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="scripts/helpers.js"></script>
  <script src="scripts/ui.js"></script>
  <script src="scripts/main.js"></script>
</body>
</html>